<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin-allow-popups">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <title>LavaWhey - Thực phẩm bổ sung chất lượng cao</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
<style>
        /* Reset CSS */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    :root {
        --primary-color: #FF6B00;
        --secondary-color: #FF8533;
        --dark-color: #333;
        --light-color: #fff;
        --gray-color: #f4f4f4;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: var(--dark-color);
    }

    /* Header & Navigation */
    .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2rem 5%;
        background-color: var(--dark-color);
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
        height: 120px;
    }

    .logo {
        display: flex;
        align-items: center;
    }

    .logo img {
        width: 90px;
        height: auto;
        object-fit: contain;
        border-radius: 50%;
        transition: transform 0.3s ease;
        padding: 5px;
        background-color: white;
    }

    .logo img:hover {
        transform: scale(1.05);
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .logo h1 {
        display: none;
    }

    .nav-links {
        display: flex;
        list-style: none;
        gap: 1.5rem;
    }

    .nav-links a {
        text-decoration: none;
        color: #ffffff;
        font-weight: 500;
        font-size: 1.1rem;
        transition: color 0.3s ease;
    }

    .nav-links a:hover,
    .nav-links a.active {
        color: var(--primary-color);
    }

    .nav-buttons {
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    .btn-login {
        padding: 0.8rem 2rem;
        background-color: var(--primary-color);
        color: var(--light-color);
        text-decoration: none;
        border-radius: 25px;
        transition: background-color 0.3s ease;
        font-size: 1.1rem;
        font-weight: 500;
    }

    .btn-login:hover {
        background-color: var(--secondary-color);
    }

    .cart-container {
        position: relative;
        margin-left: 1.5rem;
    }

    .btn-cart {
        color: var(--primary-color);
        font-size: 1.4rem;
        text-decoration: none;
        position: relative;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        border-radius: 8px;
        transition: all 0.3s ease;
        cursor: pointer;
        background-color: rgba(255, 255, 255, 0.9);
    }

    .btn-cart:hover {
        background-color: var(--light-color);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
    }

    .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background-color: var(--primary-color);
        color: var(--light-color);
        border-radius: 50%;
        min-width: 22px;
        height: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.85rem;
        font-weight: bold;
        padding: 0 4px;
        border: 2px solid var(--light-color);
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .btn-cart:hover .cart-count {
        transform: scale(1.1);
        background-color: var(--secondary-color);
        box-shadow: 0 2px 8px rgba(255, 107, 0, 0.5);
    }

    .cart-dropdown {
        position: absolute;
        top: calc(100% + 15px);
        right: 0;
        width: 400px;
        background-color: var(--light-color);
        border-radius: 16px;
        box-shadow: 0 6px 30px rgba(0,0,0,0.15);
        padding: 1.5rem;
        display: none;
        z-index: 1001;
        animation: slideDown 0.3s ease;
        border: 1px solid rgba(0,0,0,0.08);
    }

    .cart-dropdown::before {
        content: '';
        position: absolute;
        top: -8px;
        right: 20px;
        width: 16px;
        height: 16px;
        background-color: white;
        transform: rotate(45deg);
        border-left: 1px solid rgba(0,0,0,0.08);
        border-top: 1px solid rgba(0,0,0,0.08);
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .cart-dropdown.show {
        display: block;
    }

    .cart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #eee;
    }

    .cart-header h3 {
        font-size: 1.2rem;
        color: var(--dark-color);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .cart-header h3 i {
        color: var(--primary-color);
    }

    .cart-count-badge {
        background-color: var(--gray-color);
        color: var(--dark-color);
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.9rem;
    }

    .cart-items {
        max-height: 320px;
        overflow-y: auto;
        margin-bottom: 1.5rem;
    }

    .cart-items::-webkit-scrollbar {
        width: 6px;
    }

    .cart-items::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 3px;
    }

    .cart-items::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 3px;
    }

    .cart-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 0;
        border-bottom: 1px solid #eee;
        transition: all 0.3s ease;
    }

    .cart-item:last-child {
        border-bottom: none;
    }

    .cart-item:hover {
        background-color: var(--gray-color);
        padding: 1rem;
        margin: 0 -1rem;
        border-radius: 8px;
    }

    .cart-item-image {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        object-fit: cover;
        border: 1px solid #eee;
    }

    .cart-item-details {
        flex: 1;
    }

    .cart-item-name {
        font-weight: 500;
        margin-bottom: 4px;
        color: var(--dark-color);
    }

    .cart-item-price {
        color: var(--primary-color);
        font-weight: 600;
        font-size: 1.1rem;
    }

    .cart-item-quantity {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
    }

    .quantity-btn {
        background: var(--gray-color);
        border: none;
        width: 28px;
        height: 28px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
        color: var(--dark-color);
    }

    .quantity-btn:hover:not(:disabled) {
        background: var(--primary-color);
        color: var(--light-color);
    }

    .quantity-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .quantity-input {
        width: 40px;
        text-align: center;
        border: 1px solid #ddd;
        border-radius: 6px;
        padding: 4px;
    }

    .cart-item-remove {
        color: #999;
        cursor: pointer;
        padding: 4px;
        transition: all 0.2s ease;
    }

    .cart-item-remove:hover {
        color: #ff4444;
        transform: scale(1.1);
    }

    .cart-summary {
        background-color: var(--gray-color);
        border-radius: 12px;
        padding: 1.2rem;
        margin-top: 1rem;
    }

    .cart-summary-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }

    .cart-summary-row.total {
        border-top: 1px dashed #ddd;
        margin-top: 12px;
        padding-top: 12px;
        font-weight: 600;
        font-size: 1.1rem;
        color: var(--primary-color);
    }

    .cart-buttons {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .btn-checkout {
        flex: 2;
        padding: 1rem;
        background-color: var(--primary-color);
        color: var(--light-color);
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-checkout:hover {
        background-color: var(--secondary-color);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 107, 0, 0.2);
    }

    .btn-continue {
        flex: 1;
        padding: 1rem;
        background-color: var(--gray-color);
        color: var(--dark-color);
        border: none;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-continue:hover {
        background-color: var(--dark-color);
        color: var(--light-color);
    }

    .empty-cart {
        text-align: center;
        padding: 2rem 0;
    }

    .empty-cart i {
        font-size: 3rem;
        color: #ddd;
        margin-bottom: 1rem;
    }

    .empty-cart p {
        color: #999;
        margin-bottom: 1rem;
    }

    .empty-cart .btn-shop {
        display: inline-block;
        padding: 0.8rem 2rem;
        background-color: var(--primary-color);
        color: white;
        text-decoration: none;
        border-radius: 8px;
        transition: background-color 0.3s ease;
    }

    .empty-cart .btn-shop:hover {
        background-color: var(--secondary-color);
    }

    .cart-notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #4CAF50;
        color: white;
        padding: 1rem 2rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        display: flex;
        align-items: center;
        gap: 12px;
        animation: slideIn 0.3s ease-out;
        z-index: 1000;
    }

    .cart-notification i {
        font-size: 1.2rem;
    }

    /* Hero Section */
    .hero {
        position: relative;
        height: 100vh;
        min-height: 700px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: white;
        margin-top: 120px;
        overflow: hidden;
    }

    .hero-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 0;
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to right, rgba(0,0,0,0.8), rgba(0,0,0,0.4));
        z-index: 1;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        max-width: 1000px;
        padding: 0 20px;
    }

    .hero h1 {
        font-size: 5rem;
        margin-bottom: 30px;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.6);
        font-weight: 800;
        letter-spacing: 2px;
    }

    .hero p {
        font-size: 1.6rem;
        margin-bottom: 40px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
        line-height: 1.6;
    }

    .cta-button {
        display: inline-block;
        padding: 20px 50px;
        background: linear-gradient(45deg, #FF6B00, #FF8533);
        color: white;
        text-decoration: none;
        border-radius: 30px;
        font-weight: 700;
        font-size: 1.4rem;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(255, 107, 0, 0.4);
        text-transform: uppercase;
        letter-spacing: 2px;
        text-align: center;
    }

    .cta-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 25px rgba(255, 107, 0, 0.5);
        background: linear-gradient(45deg, #FF8533, #FF6B00);
    }

    .cta-button:active {
        transform: translateY(1px);
        box-shadow: 0 2px 15px rgba(255, 107, 0, 0.3);
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Featured Products (Index Page) */
    .featured-products {
        padding: 5rem 5%;
        background-color: var(--gray-color);
    }

    .featured-products h2 {
        text-align: center;
        font-size: 2.5rem;
        margin-bottom: 3rem;
        color: var(--dark-color);
    }

    .featured-products .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .featured-products .product-card {
        background: #fff;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        position: relative;
        display: flex;
        flex-direction: column;
        padding-bottom: 20px;
    }

    .featured-products .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .featured-products .product-card img {
        width: 100%;
        height: 250px;
        object-fit: contain;
        background-color: #f8f8f8;
        padding: 20px;
        transition: transform 0.3s ease;
        margin-bottom: 15px;
    }

    .featured-products .product-card:hover img {
        transform: scale(1.05);
    }

    .featured-products .product-card h3 {
        padding: 1.5rem 1.5rem 0.5rem;
        font-size: 1.2rem;
        color: var(--dark-color);
        font-weight: 600;
        margin-bottom: 10px;
    }

    .featured-products .product-card .price {
        color: #FF6B00;
        font-size: 1.3rem;
        font-weight: bold;
        padding: 0.5rem 1.5rem;
        margin-bottom: 15px;
    }

    /* Products Page Specific Styles */
    .products-section {
        padding: 6rem 5% 4rem;
        background-color: var(--gray-color);
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        gap: 1.5rem;
    }

    /* Categories */
    .categories {
        width: 200px;
        background: var(--light-color);
        padding: 1.2rem;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        height: fit-content;
        position: sticky;
        top: 100px;
    }

    .categories h2 {
        color: var(--primary-color);
        font-size: 1.3rem;
        margin-bottom: 1.2rem;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .categories h2::after {
        content: '\f107';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        transition: transform 0.3s ease;
    }

    .categories h2.active::after {
        transform: rotate(180deg);
    }

    .category-list {
        list-style: none;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }

    .category-list.show {
        max-height: 500px;
        transition: max-height 0.5s ease-in;
    }

    .category-list li {
        margin-bottom: 0.6rem;
    }

    .category-list a {
        color: var(--dark-color);
        text-decoration: none;
        font-size: 1rem;
        transition: color 0.2s;
        display: block;
        padding: 0.4rem 0;
    }

    .category-list a:hover,
    .category-list a.active {
        color: var(--primary-color);
        font-weight: 500;
    }

    /* Products Grid */
    .products-grid {
        flex: 1;
    }

    .product-category {
        margin-bottom: 2.5rem;
    }

    .product-category h2 {
        color: var(--dark-color);
        font-size: 1.8rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--primary-color);
    }

    .product-row {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start;
        gap: 15px;
        margin-bottom: 25px;
    }

    .products-section .product-card {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        padding: 12px;
        text-align: center;
        transition: transform 0.3s ease;
        width: calc(25% - 12px);
        margin: 0;
    }

    .products-section .product-card img {
        width: 100%;
        height: 180px;
        object-fit: contain;
        margin-bottom: 8px;
    }

    .products-section .product-card h3 {
        font-size: 0.95rem;
        margin: 8px 0;
        color: #333;
    }

    .products-section .product-card .description {
        font-size: 0.85rem;
        color: #666;
        margin-bottom: 8px;
        height: 36px;
        overflow: hidden;
    }

    .products-section .product-card .price {
        font-size: 1rem;
        color: #ff6b6b;
        font-weight: bold;
        margin: 8px 0;
    }

    @media (max-width: 1200px) {
        .products-section .product-card {
            width: calc(33.333% - 12px);
        }
    }

    @media (max-width: 992px) {
        .container {
            flex-direction: column;
        }
        .categories {
            width: 100%;
            position: static;
        }
        .products-section .product-card {
            width: calc(50% - 12px);
        }
    }

    @media (max-width: 576px) {
        .products-section .product-card {
            width: calc(100% - 12px);
        }
    }

    /* Benefits Section */
    .benefits {
        padding: 5rem 5%;
        background-color: var(--light-color);
    }

    .benefits h2 {
        text-align: center;
        font-size: 2.5rem;
        margin-bottom: 3rem;
    }

    .benefits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .benefit-card {
        text-align: center;
        padding: 2rem;
    }

    .benefit-card i {
        font-size: 3rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
    }

    .benefit-card h3 {
        margin-bottom: 1rem;
    }

    /* Footer */
    footer {
        background-color: var(--dark-color);
        color: var(--light-color);
        padding: 4rem 5% 2rem;
    }

    .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .footer-section h3 {
        margin-bottom: 1.5rem;
        color: var(--primary-color);
    }

    .social-links {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }

    .social-links a {
        color: var(--light-color);
        font-size: 1.5rem;
        transition: color 0.3s ease;
    }

    .social-links a:hover {
        color: var(--primary-color);
    }

    .footer-bottom {
        text-align: center;
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid rgba(255,255,255,0.1);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .nav-links {
            display: none;
        }
        
        .hero {
            height: 100vh;
        }
        
        .hero h1 {
            font-size: 2.5rem;
        }
        
        .hero p {
            font-size: 1.1rem;
        }
        
        .cta-button {
            padding: 15px 30px;
            font-size: 1rem;
        }
        
        .product-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
    }

    /* News Section */
    .news-section {
        padding: 4rem 5%;
        background-color: var(--light-color);
    }
    .news-section h2 {
        text-align: center;
        font-size: 2.2rem;
        margin-bottom: 2.5rem;
        color: var(--primary-color);
    }
    .news-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
        max-width: 1000px;
        margin: 0 auto;
    }
    @media (max-width: 900px) {
        .news-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    @media (max-width: 600px) {
        .news-grid {
            grid-template-columns: 1fr;
        }
    }
    .news-card {
        background: var(--gray-color);
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        overflow: hidden;
        transition: transform 0.2s, box-shadow 0.2s;
        display: flex;
        flex-direction: column;
    }
    .news-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
    }
    .news-card h3 {
        font-size: 1.3rem;
        margin: 1rem 1.2rem 0.5rem 1.2rem;
        color: var(--dark-color);
    }
    .news-card p {
        margin: 0 1.2rem 1rem 1.2rem;
        color: #555;
        flex: 1;
    }
    .read-more {
        display: inline-block;
        margin: 0 1.2rem 1.2rem 1.2rem;
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s;
    }
    .read-more:hover {
        color: var(--secondary-color);
    }
    .news-card:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 8px 24px rgba(255,107,0,0.12);
    }

    /* Contact Section */
    .contact-section {
        padding: 4rem 5%;
        background-color: var(--gray-color);
    }
    .contact-section h2 {
        text-align: center;
        font-size: 2.2rem;
        margin-bottom: 2.5rem;
        color: var(--primary-color);
    }
    .contact-form {
        max-width: 500px;
        margin: 0 auto;
        background: var(--light-color);
        padding: 2rem 2.5rem;
        border-radius: 15px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }
    .form-group {
        margin-bottom: 1.5rem;
    }
    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--dark-color);
        font-weight: 500;
    }
    .form-group input,
    .form-group textarea {
        width: 100%;
        padding: 0.8rem 1rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
        background: #fafafa;
        transition: border 0.2s;
    }
    .form-group input:focus,
    .form-group textarea:focus {
        border: 1.5px solid var(--primary-color);
        outline: none;
    }
    .submit-button {
        display: block;
        width: 100%;
        padding: 0.9rem;
        background: var(--primary-color);
        color: var(--light-color);
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.2s;
        margin-top: 0.5rem;
    }
    .submit-button:hover {
        background: var(--secondary-color);
    }

    .contact-container {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        max-width: 1000px;
        margin: 0 auto;
    }
    .contact-info {
        flex: 1;
        min-width: 300px;
        background: var(--light-color);
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }
    .contact-info h3 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        font-size: 1.5rem;
    }
    .contact-info p {
        margin-bottom: 0.8rem;
        color: var(--dark-color);
    }
    .contact-info i {
        margin-right: 0.5rem;
        color: var(--primary-color);
    }
    .contact-info .social-links {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }
    .contact-info .social-links a {
        color: var(--dark-color);
        font-size: 1.5rem;
        transition: color 0.3s ease;
    }
    .contact-info .social-links a:hover {
        color: var(--primary-color);
    }

    .newsletter-form {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    .newsletter-form input {
        flex: 1;
        padding: 0.8rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
    }
    .newsletter-form button {
        padding: 0.8rem 1.5rem;
        background: var(--primary-color);
        color: var(--light-color);
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.2s;
    }
    .newsletter-form button:hover {
        background: var(--secondary-color);
    }

    .search-container {
        display: flex;
        align-items: center;
        margin-left: 1.5rem;
        position: relative;
    }
    .search-input {
        padding: 0.8rem 1.2rem;
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 25px;
        font-size: 1.1rem;
        width: 250px;
        transition: width 0.3s ease;
        background-color: rgba(255,255,255,0.1);
        color: #ffffff;
    }
    .search-input:focus {
        width: 300px;
        outline: none;
        border-color: var(--primary-color);
        background-color: rgba(255,255,255,0.15);
    }
    .search-input::placeholder {
        color: rgba(255,255,255,0.7);
    }
    .search-button {
        background: var(--primary-color);
        color: var(--light-color);
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        margin-left: 0.8rem;
        cursor: pointer;
        transition: background 0.2s;
        font-size: 1.1rem;
    }
    .search-button:hover {
        background: var(--secondary-color);
    }

    .btn-cart, .btn-login {
        margin-left: 1rem;
        color: var(--dark-color);
        font-size: 1.2rem;
        text-decoration: none;
    }

    /* Individual Buy Buttons */
    .buy-button {
        background-color: #FF6B00;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        font-weight: 500;
    }

    .buy-button:hover {
        background-color: #FF8533;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(255, 107, 0, 0.2);
    }

    /* Whey Protein Buttons */
    .whey-gold {
        background-color: #FF6B00;
    }

    .whey-isolate {
        background-color: #FF6B00;
    }

    .whey-hydro {
        background-color: #FF6B00;
    }

    .whey-blend {
        background-color: #FF6B00;
    }

    /* BCAA Buttons */
    .bcaa-211 {
        background-color: #FF6B00;
    }

    .bcaa-411 {
        background-color: #FF6B00;
    }

    .bcaa-811 {
        background-color: #FF6B00;
    }

    .bcaa-energy {
        background-color: #FF6B00;
    }

    /* Pre-workout Buttons */
    .pre-explosion {
        background-color: #FF6B00;
    }

    .pre-pump {
        background-color: #FF6B00;
    }

    .pre-focus {
        background-color: #FF6B00;
    }

    .pre-endurance {
        background-color: #FF6B00;
    }

    /* Vitamin Buttons */
    .vitamin-d3 {
        background-color: #FF6B00;
    }

    .omega-3 {
        background-color: #FF6B00;
    }

    .vitamin-c {
        background-color: #FF6B00;
    }

    .magnesium {
        background-color: #FF6B00;
    }

    /* Weight Loss Buttons */
    .l-carnitine {
        background-color: #FF6B00;
    }

    .cla {
        background-color: #FF6B00;
    }

    .green-tea {
        background-color: #FF6B00;
    }

    .fat-burner {
        background-color: #FF6B00;
    }

    /* Featured Products Button */
    .featured-products .buy-button {
        background-color: #FF6B00;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        font-weight: 600;
        font-size: 1.1rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-top: 10px;
    }

    .featured-products .buy-button:hover {
        background-color: #FF8533;
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(255, 107, 0, 0.3);
    }

    /* Individual Featured Product Buttons */
    .featured-whey-gold,
    .featured-bcaa,
    .featured-pre,
    .featured-vitamin,
    .featured-carnitine,
    .featured-whey-iso {
        background-color: #FF6B00;
    }

    /* Featured Products Card Adjustments */
    .featured-products .product-card {
        padding-bottom: 20px;
    }

    .featured-products .product-card img {
        height: 250px;
        margin-bottom: 15px;
    }

    .featured-products .product-card h3 {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }

    .featured-products .product-card .price {
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: #FF6B00;
        font-weight: bold;
    }

    /* Sale Banner Section */
    .sale-banner {
        background: linear-gradient(135deg, #ff4e50, #f9d423);
        padding: 60px 20px;
        text-align: center;
        color: white;
        margin: 40px 0;
    }

    .sale-content {
        max-width: 800px;
        margin: 0 auto;
    }

    .sale-banner h2 {
        font-size: 2.5em;
        margin-bottom: 20px;
        text-transform: uppercase;
        font-weight: bold;
    }

    .sale-banner p {
        font-size: 1.2em;
        margin-bottom: 30px;
    }

    .countdown {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 30px 0;
    }

    .countdown-item {
        background: rgba(255, 255, 255, 0.2);
        padding: 15px;
        border-radius: 10px;
        min-width: 80px;
    }

    .countdown-item span:first-child {
        font-size: 2em;
        font-weight: bold;
        display: block;
    }

    .countdown-item span:last-child {
        font-size: 0.9em;
        text-transform: uppercase;
    }

    /* Discounted Products Section */
    .discounted-products {
        padding: 40px 5%;
        background: var(--gray-color);
    }

    .discounted-products h2 {
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem;
        color: var(--dark-color);
    }

    .discounted-products .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .discounted-products .product-card {
        background: #fff;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        position: relative;
        display: flex;
        flex-direction: column;
        padding-bottom: 20px;
    }

    .discounted-products .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .discounted-products .product-card img {
        width: 100%;
        height: 250px;
        object-fit: contain;
        background-color: #f8f8f8;
        padding: 20px;
        transition: transform 0.3s ease;
        margin-bottom: 15px;
    }

    .discounted-products .product-card:hover img {
        transform: scale(1.05);
    }

    .discounted-products .product-card h3 {
        padding: 0 1.5rem;
        font-size: 1.2rem;
        color: var(--dark-color);
        font-weight: 600;
        margin-bottom: 10px;
    }

    .discounted-products .product-card .original-price {
        text-decoration: line-through;
        color: #999;
        font-size: 1rem;
        margin: 5px 1.5rem;
    }

    .discounted-products .product-card .price {
        color: #ff4e50;
        font-weight: bold;
        font-size: 1.3rem;
        margin: 5px 1.5rem 15px;
    }

    .discounted-products .product-card .buy-button {
        margin: 0 1.5rem;
        padding: 12px 20px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .discounted-products .product-card .buy-button:hover {
        background: var(--secondary-color);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(255, 107, 0, 0.2);
    }

    .discounted-products .sale-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background: #ff4e50;
        color: white;
        padding: 8px 15px;
        border-radius: 25px;
        font-weight: bold;
        font-size: 1rem;
        box-shadow: 0 2px 5px rgba(255, 78, 80, 0.3);
    }

    @media (max-width: 768px) {
        .discounted-products .product-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
        
        .discounted-products .product-card img {
            height: 200px;
        }
        
        .discounted-products .product-card h3 {
            font-size: 1.1rem;
        }
        
        .discounted-products .product-card .price {
            font-size: 1.2rem;
        }
        
        .discounted-products .product-card .buy-button {
            font-size: 1rem;
            padding: 10px 15px;
        }
    }

    /* Brands Section */
    .brands-section {
        padding: 60px 5%;
        background: linear-gradient(135deg, #f6f8fa 0%, #e9ecef 100%);
    }

    .brands-section h2 {
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem;
        color: var(--dark-color);
        position: relative;
        padding-bottom: 15px;
    }

    .brands-section h2::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 3px;
        background: var(--primary-color);
    }

    .brands-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .brand-row {
        display: flex;
        justify-content: space-between;
        gap: 30px;
        margin-bottom: 30px;
    }

    .brand-item {
        flex: 1;
        background: white;
        border-radius: 20px;
        padding: 30px;
        display: flex;
        align-items: center;
        gap: 25px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .brand-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 5px;
        height: 100%;
        background: var(--primary-color);
        transition: width 0.3s ease;
    }

    .brand-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    }

    .brand-item:hover::before {
        width: 100%;
        opacity: 0.1;
    }

    .brand-logo {
        flex-shrink: 0;
        width: 120px;
        height: 120px;
        background: #f8f9fa;
        border-radius: 15px;
        padding: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.3s ease;
    }

    .brand-item:hover .brand-logo {
        transform: scale(1.1);
    }

    .brand-logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .brand-info {
        flex: 1;
    }

    .brand-info h3 {
        color: var(--dark-color);
        font-size: 1.5rem;
        margin-bottom: 10px;
        font-weight: 600;
    }

    .brand-info p {
        color: #666;
        font-size: 1.1rem;
        line-height: 1.5;
    }

    @media (max-width: 992px) {
        .brand-row {
            flex-direction: column;
            gap: 20px;
        }
        
        .brand-item {
            padding: 20px;
        }
        
        .brand-logo {
            width: 100px;
            height: 100px;
        }
        
        .brand-info h3 {
            font-size: 1.3rem;
        }
        
        .brand-info p {
            font-size: 1rem;
        }
    }

    @media (max-width: 576px) {
        .brands-section {
            padding: 40px 5%;
        }
        
        .brands-section h2 {
            font-size: 2rem;
        }
        
        .brand-item {
            flex-direction: column;
            text-align: center;
            padding: 20px;
        }
        
        .brand-logo {
            margin: 0 auto;
        }
    }

    /* Voucher Section */
    .voucher-section {
        padding: 60px 5%;
        background: linear-gradient(135deg, #fff5f5 0%, #fff0f6 100%);
    }

    .voucher-section h2 {
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem;
        color: var(--dark-color);
        position: relative;
        padding-bottom: 15px;
    }

    .voucher-section h2::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 3px;
        background: var(--primary-color);
    }

    .voucher-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .voucher-card {
        display: flex;
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
        position: relative;
    }

    .voucher-card:hover {
        transform: translateY(-5px);
    }

    .voucher-left {
        background: linear-gradient(135deg, #ff4e50 0%, #f9d423 100%);
        padding: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-width: 200px;
        color: white;
    }

    .discount {
        font-size: 3rem;
        font-weight: bold;
        line-height: 1;
    }

    .discount-text {
        font-size: 1.2rem;
        font-weight: 500;
        margin-top: 5px;
    }

    .voucher-right {
        flex: 1;
        padding: 30px;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .voucher-right h3 {
        color: var(--primary-color);
        font-size: 1.5rem;
        margin-bottom: 10px;
    }

    .voucher-right p {
        color: #666;
        font-size: 1.1rem;
        margin-bottom: 15px;
    }

    .voucher-info {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
    }

    .voucher-info span {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #888;
        font-size: 0.9rem;
    }

    .voucher-info i {
        color: var(--primary-color);
    }

    .copy-button {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        align-self: flex-start;
    }

    .copy-button:hover {
        background: var(--secondary-color);
        transform: translateY(-2px);
    }

    @media (max-width: 768px) {
        .voucher-card {
            flex-direction: column;
        }
        
        .voucher-left {
            min-width: 100%;
            padding: 20px;
        }
        
        .voucher-right {
            padding: 20px;
        }
        
        .voucher-info {
            flex-direction: column;
            gap: 10px;
        }
        
        .copy-button {
            width: 100%;
        }
    }

    /* SweetAlert2 Custom Styles */
    .swal2-container {
        z-index: 9999 !important;
    }

    .swal2-popup {
        z-index: 10000 !important;
    }

    .swal2-backdrop-show {
        z-index: 9998 !important;
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal.show {
        display: flex;
        opacity: 1;
        align-items: center;
        justify-content: center;
    }

    .modal-content {
        background-color: var(--light-color);
        border-radius: 12px;
        width: 90%;
        max-width: 400px;
        position: relative;
        transform: translateY(-20px);
        transition: transform 0.3s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .modal.show .modal-content {
        transform: translateY(0);
    }

    .close-modal {
        position: absolute;
        right: 15px;
        top: 12px;
        font-size: 20px;
        cursor: pointer;
        color: #666;
        transition: color 0.3s ease;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
    }

    .close-modal:hover {
        color: var(--primary-color);
        background-color: rgba(0,0,0,0.05);
    }

    .modal-header {
        padding: 15px 20px;
        border-bottom: 1px solid #eee;
        text-align: center;
    }

    .modal-header h2 {
        color: var(--dark-color);
        font-size: 1.5rem;
        margin: 0;
        font-weight: 600;
    }

    .modal-body {
        padding: 20px;
    }

    .modal-body .form-group {
        margin-bottom: 15px;
    }

    .modal-body .form-group label {
        display: block;
        margin-bottom: 5px;
        color: #555;
        font-size: 0.9rem;
    }

    .modal-body .form-group input {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 0.95rem;
        transition: border-color 0.3s ease;
    }

    .modal-body .form-group input:focus {
        border-color: var(--primary-color);
        outline: none;
    }

    .modal-footer {
        padding: 12px 20px;
        border-top: 1px solid #eee;
        text-align: center;
        font-size: 0.9rem;
    }

    .modal-footer a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
    }

    .modal-footer a:hover {
        text-decoration: underline;
    }

    .form-options {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 12px 0;
        font-size: 0.85rem;
    }

    .form-options label {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #666;
    }

    .form-options a {
        color: var(--primary-color);
        text-decoration: none;
    }

    .form-options a:hover {
        text-decoration: underline;
    }

    .social-login {
        margin-top: 15px;
        text-align: center;
    }

    .social-login p {
        color: #666;
        margin-bottom: 12px;
        position: relative;
        font-size: 0.9rem;
    }

    .social-login p::before,
    .social-login p::after {
        content: '';
        position: absolute;
        top: 50%;
        width: 25%;
        height: 1px;
        background-color: #ddd;
    }

    .social-login p::before {
        left: 0;
    }

    .social-login p::after {
        right: 0;
    }

    .google-login {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: white;
        color: #333;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .google-login:hover {
        background-color: #f8f8f8;
        border-color: #ccc;
    }

    .google-login img {
        width: 18px;
        height: 18px;
    }

    .submit-button {
        width: 100%;
        padding: 12px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s ease;
    }

    .submit-button:hover {
        background: var(--secondary-color);
    }

    @media (max-width: 576px) {
        .modal-content {
            width: 95%;
            margin: 10px;
        }

        .form-options {
            flex-direction: column;
            gap: 8px;
            align-items: flex-start;
        }

        .modal-header h2 {
            font-size: 1.3rem;
        }
    }

    .cart-notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #4CAF50;
        color: white;
        padding: 1rem 2rem;
        border-radius: 4px;
        animation: slideIn 0.3s ease-out;
        z-index: 1000;
    }

    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    .product-buttons {
        display: flex;
        gap: 10px;
        padding: 0 1.5rem;
    }

    .btn-add-cart {
        flex: 1;
        padding: 10px;
        background-color: white;
        color: var(--primary-color);
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .btn-add-cart:hover {
        background-color: var(--primary-color);
        color: white;
        transform: translateY(-2px);
    }

    .btn-buy-now {
        flex: 1;
        padding: 10px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .btn-buy-now:hover {
        background-color: var(--secondary-color);
        transform: translateY(-2px);
    }

    .member-main {
        max-width: 1100px;
        margin: 140px auto 40px auto;
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        justify-content: center;
    }
    .card {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.07);
        padding: 3rem 3.5rem;
        margin-bottom: 1.5rem;
        width: 100%;
        max-width: none;
        min-height: 320px;
        font-size: 1.15rem;
        box-sizing: border-box;
    }
    .member-content {
        width: 100%;
        padding-right: 0;
    }
    .member-profile.card {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .profile-info {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2rem;
        width: 100%;
    }
    .profile-avatar {
        width: 110px;
        height: 110px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid var(--primary-color);
        background: #f4f4f4;
        font-size: 2.5rem;
    }
    .profile-details {
        text-align: center;
        width: 100%;
    }
    .profile-details p {
        margin-bottom: 1.2rem;
        font-size: 1.18rem;
    }
    .edit-profile-btn {
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 32px;
        font-weight: 500;
        font-size: 1.1rem;
        cursor: pointer;
        margin-top: 8px;
        transition: background 0.2s;
    }
    .edit-profile-btn:hover {
        background: var(--secondary-color);
    }
    .orders-table-wrapper {
        overflow-x: auto;
    }
    .orders-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }
    .orders-table th, .orders-table td {
        padding: 10px 12px;
        border-bottom: 1px solid #eee;
        text-align: center;
    }
    .orders-table th {
        background: #f4f4f4;
        color: var(--primary-color);
    }
    .orders-table tr:last-child td {
        border-bottom: none;
    }
    .address-list, .voucher-list {
        list-style: none;
        padding-left: 0;
        margin-top: 1rem;
    }
    .address-item, .voucher-item {
        background: #f4f4f4;
        border-radius: 8px;
        padding: 10px 16px;
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .add-address-btn {
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 8px 18px;
        font-weight: 500;
        cursor: pointer;
        margin-top: 8px;
    }
    .add-address-btn:hover {
        background: var(--secondary-color);
    }
    .points-info {
        margin-top: 1rem;
    }
    .rank-progress {
        background: #eee;
        border-radius: 8px;
        height: 16px;
        margin: 10px 0 8px 0;
        width: 100%;
        overflow: hidden;
    }
    .rank-bar {
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        height: 100%;
        border-radius: 8px;
        transition: width 0.5s;
    }
    .rank-benefit {
        color: #888;
        font-size: 0.95rem;
    }
    .change-password-form {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 1rem;
    }
    .change-password-form input {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
    }
    .change-password-form button {
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 10px 0;
        font-weight: 500;
        cursor: pointer;
        margin-top: 8px;
    }
    .change-password-form button:hover {
        background: var(--secondary-color);
    }
    .member-logout {
        text-align: center;
        margin: 2rem 0 0 0;
    }
    .logout-btn {
        background: #ff4444;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 32px;
        font-weight: 600;
        font-size: 1.1rem;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(255,68,68,0.08);
        transition: background 0.2s;
    }
    .logout-btn:hover {
        background: #d32f2f;
    }
    @media (max-width: 900px) {
        .member-main {
            flex-direction: column;
            align-items: center;
        }
        .card {
            max-width: 98vw;
            padding: 2rem 1rem;
        }
    }
    @media (max-width: 600px) {
        .card {
            padding: 1.2rem 0.5rem;
        }
        .profile-avatar {
            width: 80px;
            height: 80px;
            font-size: 1.5rem;
        }
    }

    .member-main-2col {
        max-width: 1200px;
        margin: 140px auto 40px auto;
        display: flex;
        gap: 2.5rem;
        align-items: flex-start;
    }
    .member-sidebar {
        width: 260px;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        padding: 2.5rem 1.5rem 2rem 1.5rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: sticky;
        top: 120px;
        min-height: 400px;
    }
    .sidebar-profile {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 2rem;
    }
    .sidebar-profile img {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid var(--primary-color);
        margin-bottom: 10px;
    }
    .sidebar-name {
        font-weight: 600;
        font-size: 1.1rem;
        color: var(--primary-color);
    }
    .sidebar-menu ul {
        list-style: none;
        padding: 0;
        margin: 0;
        width: 100%;
    }
    .sidebar-menu .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 18px;
        border-radius: 8px;
        color: #333;
        font-size: 1.05rem;
        font-weight: 500;
        cursor: pointer;
        margin-bottom: 6px;
        transition: background 0.2s, color 0.2s;
    }
    .sidebar-menu .menu-item i {
        width: 22px;
        text-align: center;
        color: var(--primary-color);
    }
    .sidebar-menu .menu-item.active, .sidebar-menu .menu-item:hover {
        background: linear-gradient(90deg, #FF6B00 0%, #FF8533 100%);
        color: #fff;
    }
    .sidebar-menu .menu-item.logout-item {
        color: #ff4444;
    }
    .sidebar-menu .menu-item.logout-item.active, .sidebar-menu .menu-item.logout-item:hover {
        background: #ff4444;
        color: #fff;
    }
    .member-content {
        flex: 1;
        min-width: 0;
    }
    .member-section {
        width: 100%;
    }
    /* Card, profile, orders, address, voucher, points, password giữ nguyên như cũ */
    @media (max-width: 900px) {
        .member-main-2col {
            flex-direction: column;
            gap: 1.5rem;
        }
        .member-sidebar {
            width: 100%;
            flex-direction: row;
            align-items: flex-start;
            padding: 1.2rem 0.5rem;
            margin-bottom: 1.5rem;
            position: static;
            min-height: unset;
        }
        .sidebar-profile {
            flex-direction: row;
            align-items: center;
            margin-bottom: 0;
            margin-right: 1.5rem;
        }
        .sidebar-profile img {
            width: 50px;
            height: 50px;
            margin-bottom: 0;
            margin-right: 10px;
        }
        .sidebar-menu ul {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .sidebar-menu .menu-item {
            padding: 8px 10px;
            font-size: 0.98rem;
            margin-bottom: 0;
        }
    }
    @media (max-width: 600px) {
        .member-main-2col {
            margin: 120px 0 20px 0;
        }
        .member-sidebar {
            flex-direction: column;
            align-items: center;
            padding: 1rem 0.2rem;
        }
        .sidebar-menu ul {
            flex-direction: column;
            gap: 0;
        }
        .sidebar-menu .menu-item {
            width: 100%;
            text-align: left;
        }
    }
    .member-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        padding: 2.2rem 2.5rem 1.5rem 2.5rem;
        margin: 140px auto 30px auto;
        max-width: 1200px;
        position: relative;
        z-index: 2;
    }
    .member-header-left {
        display: flex;
        align-items: center;
        gap: 1.5rem;
    }
    .header-avatar {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid var(--primary-color);
        background: #f4f4f4;
    }
    .header-info {
        display: flex;
        flex-direction: column;
        gap: 0.7rem;
    }
    .header-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-color);
    }
    .header-row {
        display: flex;
        gap: 2.5rem;
        color: #444;
        font-size: 1.08rem;
    }
    .header-row i {
        color: var(--primary-color);
        margin-right: 5px;
    }
    .member-header-right {
        display: flex;
        align-items: center;
        gap: 2.2rem;
    }
    .header-balance {
        text-align: right;
    }
    .balance-label {
        color: #888;
        font-size: 0.98rem;
    }
    .balance-value {
        color: #FF6B00;
        font-size: 1.4rem;
        font-weight: 700;
        display: block;
    }
    .header-actions {
        display: flex;
        gap: 0.7rem;
    }
    .header-btn {
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 10px 22px;
        font-weight: 600;
        font-size: 1.05rem;
        cursor: pointer;
        transition: background 0.2s;
    }
    .header-btn:hover {
        background: var(--secondary-color);
    }
    .pay-btn {
        background: #FF6B00;
    }
    .history-btn {
        background: #FF8533;
    }
    .member-main-fpt {
        margin-top: 0;
    }
    .sidebar-section {
        margin-bottom: 2.2rem;
    }
    .sidebar-title {
        font-size: 1.08rem;
        font-weight: 700;
        color: #888;
        margin-bottom: 0.7rem;
        margin-left: 8px;
    }
    .sidebar-menu {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .sidebar-menu .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 18px;
        border-radius: 8px;
        color: #333;
        font-size: 1.05rem;
        font-weight: 500;
        cursor: pointer;
        margin-bottom: 6px;
        transition: background 0.2s, color 0.2s;
    }
    .sidebar-menu .menu-item i {
        width: 22px;
        text-align: center;
        color: var(--primary-color);
    }
    .sidebar-menu .menu-item.active, .sidebar-menu .menu-item:hover {
        background: linear-gradient(90deg, #FF6B00 0%, #FF8533 100%);
        color: #fff;
    }
    .sidebar-menu .menu-item.logout-item {
        color: #ff4444;
    }
    .sidebar-menu .menu-item.logout-item.active, .sidebar-menu .menu-item.logout-item:hover {
        background: #ff4444;
        color: #fff;
    }
    .service-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #FF6B00;
        margin-bottom: 1.2rem;
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    .service-title i {
        color: #FF6B00;
    }
    .contract-count {
        background: #eee;
        color: #FF6B00;
        border-radius: 16px;
        padding: 2px 12px;
        font-size: 0.98rem;
        margin-left: 10px;
    }
    .service-contract {
        background: #fff;
        border-radius: 14px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        padding: 1.5rem 2rem;
        margin-bottom: 2rem;
    }
    .contract-row {
        display: flex;
        gap: 2.5rem;
        margin-bottom: 1.2rem;
        font-size: 1.08rem;
    }
    .service-cards {
        display: flex;
        flex-wrap: wrap;
        gap: 1.2rem;
    }
    .service-card {
        background: #f8f8f8;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        padding: 1.2rem 1.5rem;
        min-width: 220px;
        flex: 1 1 220px;
        display: flex;
        flex-direction: column;
        gap: 0.7rem;
        position: relative;
    }
    .card-title {
        font-weight: 600;
        color: #FF6B00;
        font-size: 1.08rem;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .card-content {
        color: #333;
        font-size: 1.05rem;
    }
    .card-link {
        color: #FF6B00;
        font-size: 0.98rem;
        text-decoration: none;
        font-weight: 500;
        margin-top: 4px;
        display: inline-block;
    }
    .card-link i {
        margin-left: 4px;
    }
    .pay-type-btn {
        background: #FF6B00;
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 6px 18px;
        font-weight: 500;
        margin-right: 8px;
        cursor: pointer;
        font-size: 1rem;
    }
    .pay-type-btn.active {
        background: #FF6B00;
    }
    .pay-type-btn[disabled] {
        background: #eee;
        color: #aaa;
        cursor: not-allowed;
    }
    .card-note {
        color: #888;
        font-size: 0.95rem;
    }
    .renew-btn {
        background: #aaa;
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 6px 18px;
        font-weight: 500;
        margin-bottom: 4px;
        cursor: not-allowed;
        font-size: 1rem;
    }
    @media (max-width: 900px) {
        .member-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1.2rem;
            padding: 1.2rem 1rem 1rem 1rem;
        }
        .member-main-2col {
            flex-direction: column;
            gap: 1.5rem;
        }
        .service-cards {
            flex-direction: column;
        }
    }
    @media (max-width: 600px) {
        .member-header {
            margin: 110px 0 18px 0;
            padding: 1rem 0.5rem;
        }
        .service-contract {
            padding: 1rem 0.5rem;
        }
    }
    .member-main-whey { margin-top: 0; }
    .dashboard-stats {
        display: flex;
        gap: 2rem;
        margin-top: 1.5rem;
    }
    .stat-item {
        background: #f8f8f8;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        padding: 1.2rem 1.5rem;
        min-width: 160px;
        flex: 1 1 160px;
        text-align: center;
    }
    .stat-label { color: #888; font-size: 1.05rem; margin-bottom: 6px; }
    .stat-value { color: #FF6B00; font-size: 1.3rem; font-weight: 700; }

    /* Modal đẹp hiện đại */
    .custom-modal-bg {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.25);
        z-index: 9998;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.2s;
    }
    .custom-modal {
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.18);
        padding: 2.5rem 2.5rem 2rem 2.5rem;
        min-width: 340px;
        max-width: 95vw;
        position: relative;
        animation: popIn 0.2s;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes popIn { from { transform: scale(0.95); opacity: 0.5; } to { transform: scale(1); opacity: 1; } }
    .custom-modal h2 {
        margin-bottom: 1.2rem;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--primary-color);
        text-align: center;
    }
    .custom-modal label {
        font-weight: 500;
        color: #333;
    }
    .custom-modal input {
        width: 100%;
        padding: 10px;
        border: 1.5px solid #eee;
        border-radius: 8px;
        margin-top: 4px;
        margin-bottom: 1rem;
        font-size: 1.08rem;
        background: #fafafa;
        transition: border 0.2s;
    }
    .custom-modal input:focus {
        border: 1.5px solid var(--primary-color);
        outline: none;
    }
    .custom-modal .modal-btn {
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 32px;
        font-weight: 600;
        font-size: 1.1rem;
        cursor: pointer;
        margin-top: 8px;
        transition: background 0.2s;
        display: block;
        width: 100%;
    }
    .custom-modal .modal-btn:hover {
        background: var(--secondary-color);
    }
    .custom-modal .close-modal {
        position: absolute;
        top: 12px;
        right: 18px;
        font-size: 1.7rem;
        color: #888;
        cursor: pointer;
        border-radius: 50%;
        width: 36px; height: 36px;
        display: flex; align-items: center; justify-content: center;
        transition: background 0.2s, color 0.2s;
    }
    .custom-modal .close-modal:hover {
        background: #f4f4f4;
        color: var(--primary-color);
    }
    /* Nút Sửa/Xóa địa chỉ */
    .edit-address-btn, .delete-address-btn {
        border: none;
        border-radius: 8px;
        padding: 8px 18px;
        font-size: 1rem;
        font-weight: 500;
        margin-left: 6px;
        cursor: pointer;
        transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .edit-address-btn {
        background: var(--primary-color);
        color: #fff;
    }
    .edit-address-btn:hover {
        background: var(--secondary-color);
        color: #fff;
    }
    .delete-address-btn {
        background: #ff4444;
        color: #fff;
    }
    .delete-address-btn:hover {
        background: #d32f2f;
        color: #fff;
    }
    @media (max-width: 600px) {
        .custom-modal { padding: 1.2rem 0.5rem; min-width: 90vw; }
    }
</style>

</head>
<body>
    <!-- Header -->
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="index.html">
                    <img src="images/logo.png.png" alt="LavaWhey Logo">
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="index.html" class="active">Trang chủ</a></li>
                <li><a href="member.html">Thành viên</a></li>
                <li><a href="products.html">Sản phẩm</a></li>
                <li><a href="news.html">Tin tức</a></li>
                <li><a href="about.html">Giới thiệu</a></li>
                <li><a href="contact.html">Liên hệ</a></li>
            </ul>
            <div class="search-container">
                <input type="text" placeholder="Tìm kiếm..." class="search-input">
                <button class="search-button"><i class="fas fa-search"></i></button>
                <div class="cart-container">
                    <div class="btn-cart" onclick="window.location.href='products.html'">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <!-- Ẩn hoàn toàn dropdown giỏ hàng -->
                    <div class="cart-dropdown" style="display:none !important;"></div>
                </div>
                <a href="#" class="btn-login">Đăng nhập</a>
            </div>
        </nav>
    </header>

    <!-- Member Header Start -->
    <div class="member-header">
        <div class="member-header-left">
            <img id="headerAvatar" src="images/default-avatar.png" alt="Avatar" class="header-avatar">
            <div class="header-info">
                <div class="header-name" id="headerName">Tên khách hàng</div>
                <div class="header-row">
                    <span><i class="fas fa-envelope"></i> <span id="headerEmail">Email</span></span>
                    <span><i class="fas fa-phone"></i> <span id="headerPhone">Số điện thoại</span></span>
                </div>
            </div>
        </div>
        <div class="member-header-right">
            <div class="header-balance">
                <span class="balance-label">Tổng chi tiêu</span>
                <span class="balance-value" id="headerTotal">0 VNĐ</span>
            </div>
        </div>
    </div>
    <!-- Member Header End -->
    <main class="member-main-2col member-main-whey">
        <aside class="member-sidebar">
            <ul class="sidebar-menu">
                <li class="menu-item" data-section="dashboard"><i class="fas fa-home"></i> Tổng quan</li>
                <li class="menu-item active" data-section="profile"><i class="fas fa-user"></i> Thông tin cá nhân</li>
                <li class="menu-item" data-section="orders"><i class="fas fa-box"></i> Đơn hàng</li>
                <li class="menu-item" data-section="address"><i class="fas fa-map-marker-alt"></i> Địa chỉ giao hàng</li>
                <li class="menu-item" data-section="password"><i class="fas fa-key"></i> Đổi mật khẩu</li>
                <li class="menu-item logout-item" data-section="logout"><i class="fas fa-sign-out-alt"></i> Đăng xuất</li>
            </ul>
        </aside>
        <section class="member-content">
            <div class="member-section" id="section-dashboard" style="display:none;">
                <section class="member-dashboard card">
                    <h2>Tổng quan tài khoản</h2>
                    <div class="dashboard-stats">
                        <div class="stat-item">
                            <div class="stat-label">Tổng số đơn hàng</div>
                            <div class="stat-value" id="dashboardTotalOrders">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Tổng chi tiêu</div>
                            <div class="stat-value" id="dashboardTotalSpent">0 VNĐ</div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="member-section" id="section-profile">
                <section class="member-profile card">
                    <h2>Thông tin cá nhân</h2>
                    <div class="profile-info">
                        <img id="memberAvatar" src="images/default-avatar.png" alt="Avatar" class="profile-avatar">
                        <div class="profile-details">
                            <p><strong>Họ tên:</strong> <span id="memberName">---</span></p>
                            <p><strong>Email:</strong> <span id="memberEmail">---</span></p>
                            <p><strong>Số điện thoại:</strong> <span id="memberPhone">---</span></p>
                            <!-- Thêm provider và lastLogin -->
                            <p><strong>Nhà cung cấp:</strong> <span id="memberProvider">---</span></p>
                            <p><strong>Lần đăng nhập gần nhất:</strong> <span id="memberLastLogin">---</span></p>
                            <button class="edit-profile-btn">Chỉnh sửa</button>
                        </div>
                    </div>
                </section>
            </div>
            <div class="member-section" id="section-orders" style="display:none;">
                <section class="member-orders card">
                    <h2>Lịch sử đơn hàng</h2>
                    <div class="orders-table-wrapper">
                        <table class="orders-table">
                            <thead>
                                <tr>
                                    <th>Mã đơn</th>
                                    <th>Ngày đặt</th>
                                    <th>Trạng thái</th>
                                    <th>Tổng tiền</th>
                                    <th>Chi tiết</th>
                                </tr>
                            </thead>
                            <tbody id="ordersList">
                                <tr><td colspan="5" style="text-align:center;color:#888;">Chưa có đơn hàng</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
            <div class="member-section" id="section-address" style="display:none;">
                <section class="member-address card">
                    <h2>Địa chỉ giao hàng</h2>
                    <ul id="addressList" class="address-list">
                        <li class="address-item">Chưa có địa chỉ nào</li>
                    </ul>
                    <button class="add-address-btn">Thêm địa chỉ mới</button>
                </section>
            </div>
            <div class="member-section" id="section-password" style="display:none;">
                <section class="member-password card">
                    <h2>Đổi mật khẩu</h2>
                    <form id="changePasswordForm" class="change-password-form">
                        <input type="password" id="oldPassword" placeholder="Mật khẩu cũ" required>
                        <input type="password" id="newPassword" placeholder="Mật khẩu mới" required>
                        <input type="password" id="confirmNewPassword" placeholder="Xác nhận mật khẩu mới" required>
                        <button type="submit">Đổi mật khẩu</button>
                    </form>
                </section>
            </div>
        </section>
    </main>
    <script>
    // Sidebar menu switching logic
    document.addEventListener('DOMContentLoaded', function() {
        const menuItems = document.querySelectorAll('.sidebar-menu .menu-item');
        const sections = document.querySelectorAll('.member-section');
        menuItems.forEach(item => {
            item.addEventListener('click', function() {
                menuItems.forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                const section = this.getAttribute('data-section');
                sections.forEach(sec => sec.style.display = 'none');
                const showSection = document.getElementById('section-' + section);
                if (showSection) showSection.style.display = '';
                // Đăng xuất nhanh
                if(section === 'logout') {
                    if(window.auth && typeof window.auth.signOut === 'function') {
                        window.auth.signOut();
                    } else {
                        location.reload();
                    }
                }
            });
        });
    });
    </script>
    <!-- Member Main Content End -->

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Về LavaWhey</h3>
                <p>Chuyên cung cấp các sản phẩm whey protein và thực phẩm bổ sung chất lượng cao.</p>
            </div>
            <div class="footer-section">
                <h3>Theo dõi chúng tôi</h3>
                <p>Facebook: LavaWhey</p>
                <p>Instagram: @LavaWhey</p>
                <p>Youtube: LavaWhey</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Hỗ trợ khách hàng</h3>
                <p><i class="fas fa-headset"></i> Hotline: 0847 788 360</p>
                <p><i class="fas fa-envelope"></i> Email: LavaWhey@gmail.com</p>
                <p><i class="fas fa-question-circle"></i> Hẻm 112/12, Đường 3/2, Hưng Lợi, Ninh Kiều, TP.Cần Thơ</p>
            </div>
            <div class="footer-section">
                <h3>Đăng ký bản tin</h3>
                <p>Nhận thông tin mới nhất về sản phẩm và khuyến mãi</p>
                <form class="newsletter-form">
                    <input type="email" placeholder="Email của bạn" required>
                    <button type="submit">Đăng ký</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 LavaWhey. All rights reserved.</p>
        </div>
    </footer>

    <!-- Auth Modals -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2>Đăng nhập</h2>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Mật khẩu</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <div class="form-options">
                        <label>
                            <input type="checkbox"> Ghi nhớ đăng nhập
                        </label>
                        <a href="#" class="forgot-password">Quên mật khẩu?</a>
                    </div>
                    <button type="submit" class="submit-button">Đăng nhập</button>
                    <div class="social-login">
                        <p>Hoặc đăng nhập với</p>
                        <button type="button" class="google-login">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google">
                            Đăng nhập với Google
                        </button>
                    </div>
                </form>
                <div class="modal-footer">
                    <p>Chưa có tài khoản? <a href="#" class="switch-modal" data-target="registerModal">Đăng ký ngay</a></p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="registerModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2>Đăng ký tài khoản</h2>
            </div>
            <div class="modal-body">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerName">Họ và tên</label>
                        <input type="text" id="registerName" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPhone">Số điện thoại</label>
                        <input type="tel" id="registerPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Mật khẩu</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Xác nhận mật khẩu</label>
                        <input type="password" id="confirmPassword" required>
                    </div>
                    <div class="form-options">
                        <label>
                            <input type="checkbox" required> Tôi đồng ý với <a href="#">điều khoản sử dụng</a>
                        </label>
                    </div>
                    <button type="submit" class="submit-button">Đăng ký</button>
                </form>
                <div class="modal-footer">
                    <p>Đã có tài khoản? <a href="#" class="switch-modal" data-target="loginModal">Đăng nhập</a></p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="forgotPasswordModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2>Quên mật khẩu</h2>
            </div>
            <div class="modal-body">
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="forgotEmail">Email</label>
                        <input type="email" id="forgotEmail" required>
                    </div>
                    <button type="submit" class="submit-button">Gửi link đặt lại mật khẩu</button>
                </form>
                <div class="modal-footer">
                    <p>Đã nhớ mật khẩu? <a href="#" class="switch-modal" data-target="loginModal">Đăng nhập</a></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDPdSUkT56drPQGE9N4KvjM3ZoQaeamdao",
            authDomain: "lavawhey.firebaseapp.com",
            projectId: "lavawhey",
            storageBucket: "lavawhey.firebasestorage.app",
            messagingSenderId: "261576736130",
            appId: "1:261576736130:web:9d8b878a50e01c9591a39b",
            measurementId: "G-BR9VJHPJGL"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        // Get auth instance
        const auth = firebase.auth();

        // Google Sign-in Provider
        const googleProvider = new firebase.auth.GoogleAuthProvider();
        googleProvider.setCustomParameters({
            prompt: 'select_account'
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return; // Skip if href is just "#"
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Add to cart functionality
        document.querySelectorAll('.buy-button').forEach(button => {
            button.addEventListener('click', function() {
                const product = this.parentElement;
                const productName = product.querySelector('h3').textContent;
                alert(`Đã thêm ${productName} vào giỏ hàng!`);
            });
        });

        // Modal Functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Get modal elements
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const forgotPasswordModal = document.getElementById('forgotPasswordModal');
            const loginButton = document.querySelector('.btn-login');
            const closeButtons = document.querySelectorAll('.close-modal');
            const switchModalLinks = document.querySelectorAll('.switch-modal');
            const forgotPasswordLink = document.querySelector('.forgot-password');

            // Show login modal when clicking login button
            loginButton.addEventListener('click', function(e) {
                e.preventDefault();
                showModal(loginModal);
            });

            // Close modal when clicking close button
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const modal = this.closest('.modal');
                    hideModal(modal);
                });
            });

            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    hideModal(e.target);
                }
            });

            // Switch between modals
            switchModalLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const currentModal = this.closest('.modal');
                    const targetModalId = this.getAttribute('data-target');
                    const targetModal = document.getElementById(targetModalId);
                    
                    hideModal(currentModal);
                    showModal(targetModal);
                });
            });

            // Show forgot password modal
            forgotPasswordLink.addEventListener('click', function(e) {
                e.preventDefault();
                hideModal(loginModal);
                showModal(forgotPasswordModal);
            });

            // Helper functions
            function showModal(modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }

            function hideModal(modal) {
                modal.classList.remove('show');
                document.body.style.overflow = '';
            }

            function showSuccessMessage(message) {
                Swal.fire({
                    title: 'Thành công!',
                    text: message,
                    icon: 'success',
                    confirmButtonText: 'OK',
                    confirmButtonColor: '#FF6B00',
                    timer: 2000,
                    timerProgressBar: true
                });
            }

            function showErrorMessage(message) {
                Swal.fire({
                    title: 'Lỗi!',
                    text: message,
                    icon: 'error',
                    confirmButtonText: 'OK',
                    confirmButtonColor: '#FF6B00'
                });
            }

            function showLoadingMessage(message) {
                Swal.fire({
                    title: 'Đang xử lý...',
                    text: message,
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });
            }

            function updateUIForLoggedInUser(user) {
                const loginButton = document.querySelector('.btn-login');
                if (user) {
                    try {
                        // Lưu thông tin người dùng vào Realtime Database với xử lý lỗi
                        const database = firebase.database();
                        const userRef = database.ref('users/' + user.uid);
                        
                        // Chuẩn bị dữ liệu người dùng
                        const userData = {
                            displayName: user.displayName || '',
                            email: user.email || '',
                            photoURL: user.photoURL || '',
                            lastLogin: new Date().toISOString()
                        };

                        // Thêm thông tin provider nếu đăng nhập qua Google
                        if (user.providerData && user.providerData[0].providerId === 'google.com') {
                            userData.provider = 'google';
                            userData.googleData = {
                                email_verified: user.emailVerified,
                                created_at: user.metadata.creationTime
                            };
                        }

                        // Cập nhật dữ liệu với xử lý lỗi
                        userRef.update(userData)
                            .then(() => {
                                console.log('User data updated successfully');
                            })
                            .catch(error => {
                                console.warn('Failed to update user data:', error);
                                // Vẫn tiếp tục cập nhật UI ngay cả khi lưu DB thất bại
                            });

                        // Cập nhật UI
                        const userAvatar = document.createElement('img');
                        userAvatar.src = userData.photoURL || 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRINGA0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg==';
                        userAvatar.style.width = '30px';
                        userAvatar.style.height = '30px';
                        userAvatar.style.borderRadius = '50%';
                        userAvatar.style.marginRight = '10px';
                        userAvatar.style.verticalAlign = 'middle';
                        
                        loginButton.innerHTML = ''; // Clear existing content
                        loginButton.appendChild(userAvatar);
                        loginButton.appendChild(document.createTextNode(userData.displayName || 'Đăng xuất'));
                        loginButton.removeAttribute('href');
                        
                        // Xử lý đăng xuất
                        loginButton.onclick = function(e) {
                            e.preventDefault();
                            Swal.fire({
                                title: 'Xác nhận đăng xuất',
                                text: 'Bạn có chắc chắn muốn đăng xuất?',
                                icon: 'question',
                                showCancelButton: true,
                                confirmButtonColor: '#FF6B00',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Đăng xuất',
                                cancelButtonText: 'Hủy'
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    auth.signOut().then(() => {
                                        loginButton.innerHTML = 'Đăng nhập';
                                        loginButton.onclick = function(e) {
                                            e.preventDefault();
                                            showModal(loginModal);
                                        };
                                        hideModal(loginModal);
                                        hideModal(registerModal);
                                        hideModal(forgotPasswordModal);
                                        showSuccessMessage('Đăng xuất thành công!');
                                    }).catch((error) => {
                                        showErrorMessage('Lỗi khi đăng xuất: ' + error.message);
                                    });
                                }
                            });
                        };
                    } catch (error) {
                        console.error('Error updating UI:', error);
                        showErrorMessage('Có lỗi xảy ra khi cập nhật giao diện');
                    }
                } else {
                    loginButton.innerHTML = 'Đăng nhập';
                    loginButton.onclick = function(e) {
                        e.preventDefault();
                        showModal(loginModal);
                    };
                }
            }

            // Form submissions
            document.getElementById('loginForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                const rememberMe = document.querySelector('#loginForm input[type="checkbox"]').checked;

                showLoadingMessage('Đang đăng nhập...');
                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    if (rememberMe) {
                        await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
                    }
                    hideModal(loginModal);
                    showSuccessMessage('Đăng nhập thành công!');
                    updateUIForLoggedInUser(userCredential.user);
                } catch (error) {
                    showErrorMessage('Đăng nhập thất bại: ' + error.message);
                }
            });

            document.getElementById('registerForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const name = document.getElementById('registerName').value;
                const phone = document.getElementById('registerPhone').value;

                if (password !== confirmPassword) {
                    showErrorMessage('Mật khẩu xác nhận không khớp!');
                    return;
                }

                showLoadingMessage('Đang đăng ký...');
                try {
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    await userCredential.user.updateProfile({
                        displayName: name
                    });
                    hideModal(registerModal);
                    showSuccessMessage('Đăng ký thành công!');
                    updateUIForLoggedInUser(userCredential.user);
                } catch (error) {
                    showErrorMessage('Đăng ký thất bại: ' + error.message);
                }
            });

            document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const email = document.getElementById('forgotEmail').value;

                showLoadingMessage('Đang gửi email...');
                try {
                    await auth.sendPasswordResetEmail(email);
                    hideModal(forgotPasswordModal);
                    showSuccessMessage('Email đặt lại mật khẩu đã được gửi!');
                } catch (error) {
                    showErrorMessage('Gửi email thất bại: ' + error.message);
                }
            });

            // Google Sign-in
            const googleButtons = document.querySelectorAll('.google-login');
            googleButtons.forEach(button => {
                button.addEventListener('click', async function() {
                    showLoadingMessage('Đang chuyển hướng đến Google...');
                    try {
                        const result = await auth.signInWithPopup(googleProvider);
                        if (result.user) {
                            // Lưu thông tin bổ sung từ Google
                            const database = firebase.database();
                            const userRef = database.ref('users/' + result.user.uid);
                            const userData = {
                                displayName: result.user.displayName,
                                email: result.user.email,
                                photoURL: result.user.photoURL,
                                lastLogin: new Date().toISOString(),
                                provider: 'google',
                                googleData: {
                                    email_verified: result.user.emailVerified,
                                    created_at: result.user.metadata.creationTime
                                }
                            };
                            
                            try {
                                await userRef.update(userData);
                            } catch (dbError) {
                                console.warn('Failed to update user data:', dbError);
                            }
                            
                            hideModal(loginModal);
                            showSuccessMessage('Đăng nhập thành công!');
                            updateUIForLoggedInUser(result.user);
                        }
                    } catch (error) {
                        if (error.code === 'auth/popup-closed-by-user') {
                            showErrorMessage('Đăng nhập đã bị hủy');
                        } else {
                            showErrorMessage('Đăng nhập Google thất bại: ' + error.message);
                        }
                    }
                });
            });

            // Check auth state
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    updateUIForLoggedInUser(user);
                }
            });
        });

        // Cart functionality
        document.addEventListener('DOMContentLoaded', function() {
            const cartBtn = document.querySelector('.btn-cart');
            const cartDropdown = document.querySelector('.cart-dropdown');
            const cartItems = document.querySelector('.cart-items');
            const cartCount = document.querySelector('.cart-count');
            const cartCountBadge = document.querySelector('.cart-count-badge');
            const emptyCart = document.querySelector('.empty-cart');
            const cartSummary = document.querySelector('.cart-summary');
            const cartButtons = document.querySelector('.cart-buttons');
            
            let cart = [];
            
            // Toggle cart dropdown
            cartBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                cartDropdown.classList.toggle('show');
                updateCartDisplay();
            });

            // Close cart when clicking outside
            document.addEventListener('click', function(e) {
                if (!cartDropdown.contains(e.target) && !cartBtn.contains(e.target)) {
                    cartDropdown.classList.remove('show');
                }
            });

            // Add to cart functionality
            document.querySelectorAll('.buy-button').forEach(button => {
                button.addEventListener('click', function() {
                    const product = this.closest('.product-card');
                    const productId = product.dataset.id;
                    const productName = product.querySelector('h3').textContent;
                    const productPrice = product.querySelector('.price').textContent;
                    const productImage = product.querySelector('img').src;

                    addToCart({
                        id: productId,
                        name: productName,
                        price: productPrice,
                        image: productImage,
                        quantity: 1
                    });

                    // Show success notification
                    Swal.fire({
                        title: 'Thêm vào giỏ hàng thành công!',
                        text: productName,
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false,
                        position: 'top-end',
                        toast: true
                    });
                });
            });

            function addToCart(product) {
                const existingItem = cart.find(item => item.id === product.id);
                
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push(product);
                }
                
                updateCartDisplay();
                saveCart();
            }

            function updateCartDisplay() {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                cartCountBadge.textContent = `${totalItems} sản phẩm`;

                if (totalItems === 0) {
                    emptyCart.style.display = 'block';
                    cartSummary.style.display = 'none';
                    cartButtons.style.display = 'none';
                    cartItems.innerHTML = '';
                } else {
                    emptyCart.style.display = 'none';
                    cartSummary.style.display = 'block';
                    cartButtons.style.display = 'flex';
                    renderCartItems();
                }

                updateCartSummary();
            }

            function renderCartItems() {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item" data-id="${item.id}">
                        <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <h4 class="cart-item-name">${item.name}</h4>
                            <div class="cart-item-price">${item.price}</div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn minus" ${item.quantity === 1 ? 'disabled' : ''}>-</button>
                                <input type="number" class="quantity-input" value="${item.quantity}" min="1" max="99">
                                <button class="quantity-btn plus">+</button>
                            </div>
                        </div>
                        <i class="fas fa-times cart-item-remove"></i>
                    </div>
                `).join('');

                // Add event listeners for quantity buttons
                cartItems.querySelectorAll('.quantity-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const item = this.closest('.cart-item');
                        const id = item.dataset.id;
                        const cartItem = cart.find(i => i.id === id);
                        
                        if (this.classList.contains('plus')) {
                            cartItem.quantity++;
                        } else if (this.classList.contains('minus') && cartItem.quantity > 1) {
                            cartItem.quantity--;
                        }
                        
                        updateCartDisplay();
                        saveCart();
                    });
                });

                // Add event listeners for quantity input
                cartItems.querySelectorAll('.quantity-input').forEach(input => {
                    input.addEventListener('change', function() {
                        const item = this.closest('.cart-item');
                        const id = item.dataset.id;
                        const cartItem = cart.find(i => i.id === id);
                        const newQuantity = parseInt(this.value);
                        
                        if (newQuantity > 0 && newQuantity < 100) {
                            cartItem.quantity = newQuantity;
                            updateCartDisplay();
                            saveCart();
                        } else {
                            this.value = cartItem.quantity;
                        }
                    });
                });

                // Add event listeners for remove buttons
                cartItems.querySelectorAll('.cart-item-remove').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const item = this.closest('.cart-item');
                        const id = item.dataset.id;
                        cart = cart.filter(i => i.id !== id);
                        updateCartDisplay();
                        saveCart();
                    });
                });
            }

            function updateCartSummary() {
                const subtotal = cart.reduce((sum, item) => {
                    const price = parseInt(item.price.replace(/[^\d]/g, ''));
                    return sum + (price * item.quantity);
                }, 0);

                const shipping = subtotal > 0 ? 30000 : 0; // Phí ship 30k cho đơn hàng có sản phẩm
                const total = subtotal + shipping;

                const summaryRows = cartDropdown.querySelectorAll('.cart-summary-row');
                summaryRows[0].querySelector('span:last-child').textContent = formatPrice(subtotal);
                summaryRows[1].querySelector('span:last-child').textContent = formatPrice(shipping);
                summaryRows[2].querySelector('span:last-child').textContent = formatPrice(total);
            }

            function formatPrice(price) {
                return new Intl.NumberFormat('vi-VN', {
                    style: 'currency',
                    currency: 'VND'
                }).format(price);
            }

            function saveCart() {
                localStorage.setItem('cart', JSON.stringify(cart));
            }

            function loadCart() {
                const savedCart = localStorage.getItem('cart');
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                    updateCartDisplay();
                }
            }

            // Load cart on page load
            loadCart();

            // Handle continue shopping button
            document.querySelector('.btn-continue').addEventListener('click', function() {
                cartDropdown.classList.remove('show');
            });

            // Handle checkout button
            document.querySelector('.btn-checkout').addEventListener('click', function() {
                if (cart.length > 0) {
                    // Implement checkout logic here
                    Swal.fire({
                        title: 'Tiến hành thanh toán',
                        text: 'Chức năng đang được phát triển',
                        icon: 'info'
                    });
                }
            });
        });

        // Lấy thông tin khách hàng từ Firebase và hiển thị
        if (window.firebase && window.firebase.auth) {
            const auth = firebase.auth();
            const database = firebase.database();
            let currentUser = null;

            // Helper: Hiển thị thông báo
            function showSuccess(msg) {
                Swal.fire({icon:'success',title:'Thành công',text:msg,confirmButtonColor:'#FF6B00'});
            }
            function showError(msg) {
                Swal.fire({icon:'error',title:'Lỗi',text:msg,confirmButtonColor:'#FF6B00'});
            }

            // 1. Lấy & cập nhật thông tin cá nhân
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    currentUser = user;
                    const userRef = database.ref('users/' + user.uid);
                    userRef.on('value', function(snapshot) {
                        const data = snapshot.val() || {};
                        // Header
                        document.getElementById('headerAvatar').src = data.photoURL || user.photoURL || 'images/default-avatar.png';
                        document.getElementById('headerName').textContent = data.displayName || user.displayName || 'Khách hàng';
                        document.getElementById('headerEmail').textContent = data.email || user.email || '';
                        document.getElementById('headerPhone').textContent = data.phone || '';
                        document.getElementById('headerTotal').textContent = (data.totalSpent ? data.totalSpent.toLocaleString('vi-VN') + ' VNĐ' : '0 VNĐ');
                        // Thông tin cá nhân
                        document.getElementById('memberAvatar').src = data.photoURL || user.photoURL || 'images/default-avatar.png';
                        document.getElementById('memberName').textContent = data.displayName || user.displayName || '---';
                        document.getElementById('memberEmail').textContent = data.email || user.email || '---';
                        document.getElementById('memberPhone').textContent = data.phone || '---';
                        // Form chỉnh sửa (nếu đang mở)
                        if(document.getElementById('editProfileModal')) {
                            document.getElementById('editName').value = data.displayName || user.displayName || '';
                            document.getElementById('editEmail').value = data.email || user.email || '';
                            document.getElementById('editPhone').value = data.phone || '';
                        }
                        // Trong JS, sau khi lấy data từ Firebase:
                        document.getElementById('memberProvider').textContent = data.provider || '---';
                        document.getElementById('memberLastLogin').textContent = data.lastLogin 
                            ? new Date(data.lastLogin).toLocaleString('vi-VN') 
                            : '---';
                    });
                    // Địa chỉ giao hàng
                    loadAddresses();
                    // Đơn hàng
                    loadOrders();
                }
            });

            // 1.1. Chỉnh sửa thông tin cá nhân
            document.querySelector('.edit-profile-btn').addEventListener('click', async function() {
                if (!currentUser) return;
                // Lấy dữ liệu user mới nhất từ Firebase
                const userSnap = await database.ref('users/' + currentUser.uid).once('value');
                const data = userSnap.val() || {};
                let modal = document.getElementById('editProfileModal');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'editProfileModal';
                    modal.className = 'custom-modal-bg';
                    modal.innerHTML = `
                    <div class="custom-modal">
                        <span class="close-modal" id="closeEditProfile">&times;</span>
                        <h2>Chỉnh sửa thông tin</h2>
                        <form id="editProfileForm">
                            <label>Họ tên:</label>
                            <input id="editName" type="text" required>
                            <label>Email:</label>
                            <input id="editEmail" type="email" required>
                            <label>Số điện thoại:</label>
                            <input id="editPhone" type="tel">
                            <button type="submit" class="modal-btn">Lưu</button>
                        </form>
                    </div>`;
                    document.body.appendChild(modal);
                    document.getElementById('closeEditProfile').onclick = function() {
                        modal.remove();
                    };
                    document.getElementById('editProfileForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const name = document.getElementById('editName').value.trim();
                        const email = document.getElementById('editEmail').value.trim();
                        const phone = document.getElementById('editPhone').value.trim();
                        try {
                            await currentUser.updateProfile({displayName: name});
                            if(currentUser.email !== email) await currentUser.updateEmail(email);
                            await database.ref('users/' + currentUser.uid).update({displayName: name, email: email, phone: phone});
                            showSuccess('Cập nhật thông tin thành công!');
                            modal.remove();
                        } catch(err) {
                            showError('Cập nhật thất bại: ' + err.message);
                        }
                    };
                }
                // Luôn gán dữ liệu mới nhất vào input
                document.getElementById('editName').value = data.displayName || currentUser.displayName || '';
                document.getElementById('editEmail').value = data.email || currentUser.email || '';
                document.getElementById('editPhone').value = data.phone || '';
            });

            // 2. Địa chỉ giao hàng
            function loadAddresses() {
                if (!currentUser) return;
                const list = document.getElementById('addressList');
                database.ref('users/' + currentUser.uid + '/addresses').once('value').then(snap => {
                    const data = snap.val() || {};
                    list.innerHTML = '';
                    const keys = Object.keys(data);
                    if(keys.length === 0) {
                        list.innerHTML = '<li class="address-item">Chưa có địa chỉ nào</li>';
                    } else {
                        keys.forEach(key => {
                            const addr = data[key];
                            const li = document.createElement('li');
                            li.className = 'address-item';
                            li.innerHTML = `<span>${addr.text || ''}</span>
                            <span>
                                <button class="edit-address-btn" data-id="${key}">Sửa</button>
                                <button class="delete-address-btn" data-id="${key}">Xóa</button>
                            </span>`;
                            list.appendChild(li);
                        });
                    }
                });
            }
            document.querySelector('.add-address-btn').onclick = function() {
                if (!currentUser) return;
                Swal.fire({
                    title: 'Thêm địa chỉ mới',
                    input: 'text',
                    inputLabel: 'Địa chỉ',
                    inputPlaceholder: 'Nhập địa chỉ giao hàng...',
                    showCancelButton: true,
                    confirmButtonText: 'Lưu',
                    cancelButtonText: 'Hủy',
                    inputValidator: value => !value && 'Vui lòng nhập địa chỉ!'
                }).then(async result => {
                    if(result.isConfirmed && result.value) {
                        const newKey = database.ref().child('users/' + currentUser.uid + '/addresses').push().key;
                        await database.ref('users/' + currentUser.uid + '/addresses/' + newKey).set({text: result.value});
                        showSuccess('Đã thêm địa chỉ!');
                        loadAddresses();
                    }
                });
            };
            document.getElementById('addressList').onclick = async function(e) {
                if(e.target.classList.contains('edit-address-btn')) {
                    const id = e.target.getAttribute('data-id');
                    // Lấy lại địa chỉ từ Firebase
                    const snap = await database.ref('users/' + currentUser.uid + '/addresses/' + id).once('value');
                    const addr = snap.val() || {};
                    Swal.fire({
                        title: 'Sửa địa chỉ',
                        input: 'text',
                        inputValue: addr.text || '',
                        showCancelButton: true,
                        confirmButtonText: 'Lưu',
                        cancelButtonText: 'Hủy',
                        inputValidator: value => !value && 'Vui lòng nhập địa chỉ!'
                    }).then(async result => {
                        if(result.isConfirmed && result.value) {
                            await database.ref('users/' + currentUser.uid + '/addresses/' + id).set({text: result.value});
                            showSuccess('Đã cập nhật địa chỉ!');
                            loadAddresses();
                        }
                    });
                }
                if(e.target.classList.contains('delete-address-btn')) {
                    const id = e.target.getAttribute('data-id');
                    Swal.fire({title:'Xác nhận xóa',text:'Bạn chắc chắn muốn xóa địa chỉ này?',icon:'warning',showCancelButton:true,confirmButtonColor:'#FF6B00',cancelButtonColor:'#d33',confirmButtonText:'Xóa',cancelButtonText:'Hủy'}).then(async result => {
                        if(result.isConfirmed) {
                            await database.ref('users/' + currentUser.uid + '/addresses/' + id).remove();
                            showSuccess('Đã xóa địa chỉ!');
                            loadAddresses();
                        }
                    });
                }
            };

            // 3. Lịch sử đơn hàng
            function loadOrders() {
                if (!currentUser) return;
                const tbody = document.getElementById('ordersList');
                database.ref('invoices').once('value').then(snap => {
                    const data = snap.val() || {};
                    tbody.innerHTML = '';
                    // Lấy email user hiện tại
                    const userEmail = currentUser.email;
                    // Lọc đơn hàng theo email
                    const userOrders = Object.entries(data).filter(([key, order]) => {
                        return order.customer && order.customer.email === userEmail;
                    });
                    if (userOrders.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#888;">Chưa có đơn hàng</td></tr>';
                    } else {
                        // Sắp xếp mới nhất lên đầu
                        userOrders.sort((a, b) => new Date(b[1].createdAt) - new Date(a[1].createdAt));
                        userOrders.forEach(([key, order]) => {
                            const date = order.createdAt ? new Date(order.createdAt).toLocaleString('vi-VN') : '';
                            const status = order.status || order.paymentStatus || '';
                            const total = order.total ? order.total.toLocaleString('vi-VN') + ' VNĐ' : '';
                            tbody.innerHTML += `<tr>
                                <td>${key}</td>
                                <td>${date}</td>
                                <td>${status}</td>
                                <td>${total}</td>
                                <td><a href="#" class="order-detail-link" data-id="${key}">Xem</a></td>
                            </tr>`;
                        });
                    }
                    // Tổng quan
                    document.getElementById('dashboardTotalOrders').textContent = userOrders.length;
                    let totalSpent = 0;
                    userOrders.forEach(([k, order]) => { if(order.total) totalSpent += order.total; });
                    document.getElementById('dashboardTotalSpent').textContent = totalSpent.toLocaleString('vi-VN') + ' VNĐ';
                    // Lưu tổng chi tiêu vào user
                    database.ref('users/' + currentUser.uid + '/totalSpent').set(totalSpent);

                    // Gắn lại sự kiện cho các nút "Xem" (phải nằm trong callback này)
                    tbody.querySelectorAll('.order-detail-link').forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const orderId = this.getAttribute('data-id');
                            // Lấy lại dữ liệu đơn từ invoices
                            database.ref('invoices/' + orderId).once('value').then(snap => {
                                const order = snap.val();
                                if (!order) return Swal.fire('Không tìm thấy đơn hàng!');
                                // Hiển thị chi tiết đơn hàng với giao diện đẹp
                                const status = order.status || order.paymentStatus || '';
                                const statusColor = status === 'paid' || status === 'success' ? '#4CAF50' : (status === 'pending' ? '#FF9800' : '#F44336');
                                let html = `
                                    <div style="display:flex;gap:24px;flex-wrap:wrap;justify-content:space-between;">
                                        <div style="flex:1;min-width:220px;">
                                            <h3 style='margin:0 0 8px 0;font-size:1.1rem;color:#FF6B00;'>Thông tin đơn hàng</h3>
                                            <div style='margin-bottom:8px;'><b>Mã đơn:</b> <span style='color:#333;'>${orderId}</span></div>
                                            <div style='margin-bottom:8px;'><b>Ngày đặt:</b> <span style='color:#333;'>${order.createdAt ? new Date(order.createdAt).toLocaleString('vi-VN') : ''}</span></div>
                                            <div style='margin-bottom:8px;'><b>Trạng thái:</b> <span style='color:${statusColor};font-weight:600;text-transform:uppercase;'>${status}</span></div>
                                            <div style='margin-bottom:8px;'><b>Mã giảm giá:</b> <span style='color:#333;'>${order.coupon || '-'}</span></div>
                                            <div style='margin-bottom:8px;'><b>Giảm giá:</b> <span style='color:#333;'>${order.discountAmount ? order.discountAmount.toLocaleString('vi-VN') + ' VNĐ' : '-'}</span></div>
                                            <div style='margin-bottom:8px;'><b>Tổng tiền:</b> <span style='color:#FF6B00;font-size:1.2rem;font-weight:700;'>${order.total ? order.total.toLocaleString('vi-VN') + ' VNĐ' : ''}</span></div>
                                        </div>
                                        <div style="flex:1;min-width:220px;">
                                            <h3 style='margin:0 0 8px 0;font-size:1.1rem;color:#FF6B00;'>Khách hàng</h3>
                                            <div style='margin-bottom:8px;'><b>Họ tên:</b> <span style='color:#333;'>${order.customer ? (order.customer.firstName + ' ' + order.customer.lastName) : ''}</span></div>
                                            <div style='margin-bottom:8px;'><b>Địa chỉ:</b> <span style='color:#333;'>${order.customer ? order.customer.address : ''}</span></div>
                                            <div style='margin-bottom:8px;'><b>SĐT:</b> <span style='color:#333;'>${order.customer ? order.customer.phone : ''}</span></div>
                                            <div style='margin-bottom:8px;'><b>Email:</b> <span style='color:#333;'>${order.customer ? order.customer.email : ''}</span></div>
                                        </div>
                                    </div>
                                    <hr style='margin:18px 0 12px 0;border:0;border-top:1.5px solid #eee;'>
                                    <h3 style='font-size:1.1rem;color:#FF6B00;margin-bottom:8px;'>Danh sách sản phẩm</h3>
                                    <div style='overflow-x:auto;'>
                                    <table style='width:100%;border-collapse:collapse;font-size:1rem;'>
                                        <thead>
                                            <tr style='background:#f8f8f8;'>
                                                <th style='padding:8px 6px;border-bottom:2px solid #FF6B00;text-align:left;'>Ảnh</th>
                                                <th style='padding:8px 6px;border-bottom:2px solid #FF6B00;text-align:left;'>Tên sản phẩm</th>
                                                <th style='padding:8px 6px;border-bottom:2px solid #FF6B00;'>SL</th>
                                                <th style='padding:8px 6px;border-bottom:2px solid #FF6B00;'>Đơn giá</th>
                                                <th style='padding:8px 6px;border-bottom:2px solid #FF6B00;'>Thành tiền</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${order.items.map(item => `
                                                <tr>
                                                    <td style='padding:6px 4px;'><img src="${item.image}" style="width:48px;height:48px;object-fit:cover;border-radius:6px;box-shadow:0 2px 8px #eee;"></td>
                                                    <td style='padding:6px 4px;color:#333;font-weight:500;'>${item.name}</td>
                                                    <td style='padding:6px 4px;text-align:center;'>${item.quantity}</td>
                                                    <td style='padding:6px 4px;text-align:right;'>${item.price.toLocaleString('vi-VN')} VNĐ</td>
                                                    <td style='padding:6px 4px;text-align:right;font-weight:600;'>${(item.price*item.quantity).toLocaleString('vi-VN')} VNĐ</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                    </div>
                                `;
                                Swal.fire({
                                    title: 'Chi tiết đơn hàng',
                                    html: html,
                                    width: 700,
                                    confirmButtonColor: '#FF6B00',
                                    showCloseButton: true
                                });
                            });
                        });
                    });
                });

            }

            // 4. Đổi mật khẩu
            document.getElementById('changePasswordForm').onsubmit = async function(e) {
                e.preventDefault();
                const oldPass = document.getElementById('oldPassword').value;
                const newPass = document.getElementById('newPassword').value;
                const confirmPass = document.getElementById('confirmNewPassword').value;
                if(newPass !== confirmPass) return showError('Mật khẩu xác nhận không khớp!');
                try {
                    // Re-authenticate
                    const cred = firebase.auth.EmailAuthProvider.credential(currentUser.email, oldPass);
                    await currentUser.reauthenticateWithCredential(cred);
                    await currentUser.updatePassword(newPass);
                    showSuccess('Đổi mật khẩu thành công!');
                    document.getElementById('changePasswordForm').reset();
                } catch(err) {
                    showError('Đổi mật khẩu thất bại: ' + err.message);
                }
            };
        }
    </script>
    <script>
        
    </script>
</body>
</html> 
